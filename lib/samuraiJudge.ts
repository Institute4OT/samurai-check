// 統一されたコード：samuraiJudge.ts
export type SamuraiType =
  | "真田幸村型"
  | "織田信長型"
  | "豊臣秀吉型"
  | "徳川家康型"
  | "上杉謙信型"
  | "斎藤道三型"
  | "今川義元型";

export interface CategoryScores {
  "アップデート力": number;
  "コミュ力誤差": number;
  "ジェネギャップ感覚": number;
  "組織進化阻害": number;
  "無自覚ハラスメント傾向": number;
  "権限委譲・構造健全度": number;
}

export const samuraiDescriptions: Record<SamuraiType, string> = {
  "真田幸村型": "全体的に高得点のバランス型。挑戦も安定もこなす理想の経営者タイプ。",
  "織田信長型": "攻めの判断が速く、変化を恐れないチャレンジャー。AI時代の勝ち筋を先読みする。",
  "徳川家康型": "組織の土台を堅実に整え、信頼で築く安定政権型。改革よりも継続が強み。",
  "豊臣秀吉型": "人たらし力と突破力を兼ね備えた柔軟型。現場の声に敏感で、巻き込み型のリーダー。",
  "斎藤道三型": "野心と改革精神に満ちた一匹狼型。周囲と衝突しやすいが、独自の道を切り拓く。",
  "上杉謙信型": "倫理観が強く、精神性と信頼を大切にするリーダー。組織の\"軸\"を支える存在。",
  "今川義元型": "今のままでは時代に取り残される恐れが…。まずは現状把握と意識変革から。"
};

export function judgeSamuraiType(scores: CategoryScores): SamuraiType {
  const {
    アップデート力,
    コミュ力誤差,
    ジェネギャップ感覚,
    組織進化阻害,            // ※UIでは高い=良好（阻害が少ない）
    無自覚ハラスメント傾向,  // ※UIでは高い=良好（ハラレス）
    "権限委譲・構造健全度": delegationHealth,
  } = scores;

  const vals = [
    アップデート力,
    コミュ力誤差,
    ジェネギャップ感覚,
    組織進化阻害,
    無自覚ハラスメント傾向,
    delegationHealth,
  ];

  const avg = vals.reduce((a, b) => a + b, 0) / vals.length;

  // 0) 全体が十分良好なら最優先で「真田幸村型」
  //   （UIの“良好”帯に合わせて 2.5 をしきいに）
  if (vals.every(v => v >= 2.5)) {
    return "真田幸村型";
  }

  // 1) 停滞型：今川義元型（全体的に低い）
  if (avg < 1.4) {
    return "今川義元型";
  }

  // 2) 独裁型：斎藤道三型
  //    攻めは強いが、ハラレス/組織健全が低い（=リスク高）の組合せ
  if (
    アップデート力 >= 2.3 &&
    (無自覚ハラスメント傾向 <= 1.5 || 組織進化阻害 <= 1.5 || delegationHealth <= 1.6)
  ) {
    return "斎藤道三型";
  }

  // 3) 革新型：織田信長型（攻め強い＋ギャップ対応OK＋ハラレス良好）
  if (
    アップデート力 >= 2.4 &&
    ジェネギャップ感覚 >= 2.2 &&
    無自覚ハラスメント傾向 >= 2.0
  ) {
    return "織田信長型";
  }

  // 4) 高潔型：上杉謙信型（信頼・倫理が高く、変化はやや慎重）
  if (
    コミュ力誤差 >= 2.5 &&
    ジェネギャップ感覚 >= 2.5 &&
    無自覚ハラスメント傾向 >= 2.4 &&
    アップデート力 < 2.0
  ) {
    return "上杉謙信型";
  }

  // 5) 慎重型：徳川家康型（土台は強いがアップデートは控えめ）
  if (delegationHealth >= 2.5 && アップデート力 < 1.8) {
    return "徳川家康型";
  }

  // 6) 共創型：豊臣秀吉型（コミュ力・巻き込み・健全度がバランス良い）
  if (
    コミュ力誤差 >= 2.2 &&
    delegationHealth >= 2.0 &&
    組織進化阻害 >= 2.2
  ) {
    return "豊臣秀吉型";
  }

  // Fallback
  return "豊臣秀吉型";
}
